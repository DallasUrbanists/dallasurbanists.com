---
layout: default
identity_snippet: true
---
{% for post in site.posts %}
  {% if post.tags contains "Featured" %}
    {% unless featured_post %}
      {% assign featured_post = post %}
      {% assign featured_author = site.authors | where: 'name', featured_post.author | first %}
      {% assign d = featured_post.date | date: "%-d" %}
      {% capture ordinal %}
        {% case d %}
          {% when "1" or "21" or "31" %}st
          {% when "2" or "22" %}nd
          {% when "3" or "23" %}rd
          {% else %}th
        {% endcase %}
      {% endcapture %}
    {% endunless %}
  {% endif %}
  {% unless transportation_post %}
    {% if post.tags contains "DART" and post != featured_post %}
      {% assign transportation_post = post %}
    {% endif %}
  {% endunless %}
  {% unless housing_post %}
    {% if post.tags contains "Housing" and post != featured_post %}
      {% assign housing_post = post %}
    {% endif %}
  {% endunless %}
{% endfor %}
<div class="container-lg p-4 py-2">
  <div class="row flex-lg-row-reverse align-items-center position-relative">
    <div class="col-lg-8 text-center id="featuredContainer">
      <h1 class="display-6">
        <a href="{{ featured_post.url | prepend: site.baseurl }}" class="stretched-link link-dark link-underline-opacity-0 d-inline-block" id="featuredTitle">{{ featured_post.title }}</a>
      </h1>
      <p class="mb-4" id="featuredSubtitle">
        {{ featured_post.subtitle }}
        &mdash;
        <em>{{ featured_author.display_name }}, {{ featured_post.date | date: "%B %-d" }}<sup>{{ ordinal }}</sup></em>
      </p>
    </div>
    <div class="col-12 col-lg-4">
      <img
        src="{{ featured_post.cover_image | relative_url }}"
        class="d-block mx-lg-auto img-fluid rounded"
        loading="lazy">
    </div>
  </div>
</div>

<div class="container-lg p-4">
  <div class="row g-5">
    <div class="col-12 col-md-8 mb-md-5">
      {% include lined-heading.html text = "Most Recent" %}
      {% include post-list.html exclude=featured_post limit=5 %}
      {% include more-button.html path = "/blog" label = "See more recent posts" %}
    </div>
    <div class="col-12 col-md-4 mb-md-5">
      {% include lined-heading.html text = "About" %}
      <p class="mb-4"><i>This Dallas Life</i> is an urbanist blog focused on transportation and housing in the City of Dallas and the Greater Dallas area. Our purpose is to promote thoughtful discussions about walkability, housing, public transit, mobility, and sustainable city planning.</p>

      <form {% include newsletter-form-attributes.html %}>
        {% include newsletter-input.html %}
      </form>

      <div class="mb-4">
        {% for tag in site.tags %}
          <a href="#" class="tag-link">Topic</a>
        {% endfor %}
      </div>
    </div>
  </div>

  {% include lined-heading.html text = "Transportation" %}
  <div class="row flex-lg-row-reverse g-5">
    <div class="col-12 col-md-4 mb-0">
      {% assign author = site.authors | where: 'name', transportation_post.author | first %}
      <div class="position-relative blog-listing" style="text-wrap: balance;">
        <div class="mb-2">
          <img class="img-fluid muted rounded" src="{{ transportation_post.cover_image | relative_url }}">
        </div>
        <div class="">
          <b><a href="{{ transportation_post.url | prepend: site.baseurl }}" class="link-dark link-underline-opacity-0 stretched-link listing-link">{{ transportation_post.title }}</a></b>
          <br>
          {{ transportation_post.subtitle }}
          &mdash;
          <em>{{ author.display_name }}, {{ transportation_post.date | date: "%B %-d, %Y" }}</em>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-8 mb-md-5 mt-4 mt-lg-5">
      {% include post-list.html tag="DART" limit=5 %}
      {% include more-button.html path = "/blog" label = "See more posts about transportation" %}
    </div>
  </div>

  {% include lined-heading.html text = "Housing" %}
  <div class="row flex-lg-row-reverse g-5">
    <div class="col-12 col-md-4 mb-0">
      {% assign author = site.authors | where: 'name', housing_post.author | first %}
      <div class="position-relative blog-listing" style="text-wrap: balance;">
        <div class="mb-2">
          <img class="img-fluid muted rounded" src="{{ housing_post.cover_image | relative_url }}">
        </div>
        <div class="">
          <b><a href="{{ housing_post.url | prepend: site.baseurl }}" class="link-dark link-underline-opacity-0 stretched-link listing-link">{{ housing_post.title }}</a></b>
          <br>
          {{ housing_post.subtitle }}
          &mdash;
          <em>{{ author.display_name }}, {{ housing_post.date | date: "%B %-d, %Y" }}</em>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-8 mb-md-5 mt-4 mt-lg-5">
      {% include post-list.html tag="Housing" limit=5 %}
      {% include more-button.html path = "/blog" label = "See more posts about housing" %}
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    let featuredContainer = document.querySelector("#featuredContainer");
    let featuredTitle = document.querySelector("#featuredTitle");
    let featuredSubtitle = document.querySelector("#featuredSubtitle");
    let originalTitleSize = featuredTitle.style.fontSize;
    let originalSubtitleSize = featuredSubtitle.style.fontSize;

    function fitTitleWidth() {
      let fontSize = window.getComputedStyle(featuredTitle).fontSize;
      let containerPadding = parseFloat(window.getComputedStyle(featuredContainer).paddingLeft) + parseFloat(window.getComputedStyle(featuredContainer).paddingRight);
      let targetWidth = featuredContainer.clientWidth - (containerPadding * 4);

      if(featuredTitle.clientWidth < targetWidth){
        featuredTitle.style.fontSize = (parseFloat(fontSize) + 1) + 'px';
        fitTitleWidth();
      }
    }

    function fitSubtitleHeight(containerMaxHeight) {
      let fontSize = parseFloat(window.getComputedStyle(featuredSubtitle).fontSize);
      let fontSizeMax = parseFloat(window.getComputedStyle(featuredTitle).fontSize) * 0.5;
      let contentMargins = parseFloat(window.getComputedStyle(featuredTitle).marginBottom) + parseFloat(window.getComputedStyle(featuredSubtitle).marginBottom);
      let targetHeight = Math.min(featuredContainer.clientHeight, containerMaxHeight);
      let testHeight = featuredTitle.clientHeight + featuredSubtitle.clientHeight + (contentMargins * 2);
      
      if(testHeight < targetHeight && fontSize <= fontSizeMax) {
        featuredSubtitle.style.fontSize = (parseFloat(fontSize) + 1) + 'px';
        fitSubtitleHeight(featuredContainer.clientHeight);
      }
    }

    function fitTitles() {
      featuredTitle.style.fontSize = originalTitleSize;
      featuredSubtitle.style.fontSize = originalSubtitleSize;

      fitTitleWidth();
      fitSubtitleHeight(featuredContainer.clientHeight);
    }

    fitTitles();

    window.addEventListener('resize', function(event) {
      fitTitles();
    }, true);

    // The subtitle usually resizes on page load successfully, but for some reason it randomly
    // doesn't work. So this interval is me cheating by calling the resize function every couple seconds.
    setInterval(function () { fitSubtitleHeight(featuredContainer.clientHeight); }, 1000);
  });
</script>